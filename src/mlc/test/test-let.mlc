#include "list.mlc".

#echo "Testing basic let expressions".
let {x := fail} pass.
let {x := pass} x.
let {x := 1} 1.
let {x := 1} x + x.
let {x := 1. y := 2} x + y.
let {id := [x. x]} id (pass).

#echo "Testing evaluation in let values".
let {x := 1 + 1. y := 2 + 3} [x | y].
let {p := [nil; $is-nil? pass | fail]} p.

#echo "Testing unevaluable let values".
let {x := foo + bar} x.
let {x := f (foo). y := g (bar)} x + y.

#echo "Testing nested lets".
let {x := 1. y := 10} let {z := 100. w := 1000} x + z + y + w.

#echo "Testing let in various positions".
[x. x - 1] (let {y := 9} y).
