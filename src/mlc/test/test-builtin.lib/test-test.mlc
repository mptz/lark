$echo "Testing un-evaluated tests".
[#p? #a | #b].
[#p + 1? #a | #b].
[x. [x? #a | #b]].
[x, y. [x; y? #a | #b]].
[[x. x]? #a | #b].
[[x. x; 5] (3 + 3)? #a | #b].

$echo "Testing test evaluation".
[0? #fail | #pass].
[1? #pass | #fail].
[1 - 1? #fail | #pass].
[0 + 1? #pass | #fail].
[[x. x] (0)? #fail | #pass].
[[x. x] (1)? #pass | #fail].
[[0? 0 | 1]? #pass | #fail].
[[0? 0 | 1] - 1? #fail | #pass].
[0? [x, y. x] | [x, y. y]] (#fail, #pass).

$echo "Testing tests with equality primitives".
[0 == 0? #pass | #fail].
[0 == 1? #fail | #pass].
[1 == 1? #pass | #fail].
[1 == 2? #fail | #pass].
[2 == 1 + 1? #pass | #fail].
[1 + 1 == 2? #pass | #fail].
[0 <> 0? #fail | #pass].
[0 <> 1? #pass | #fail].
[1 <> 1? #fail | #pass].
[1 <> 2? #pass | #fail].
[2 <> 1 + 1? #fail | #pass].
[1 + 1 <> 2? #fail | #pass].

$echo "Testing tests with inequality primitives".
[1 < 2? #pass | #fail].
[2 < 1? #fail | #pass].
[1 + 1 <= 2? #pass | #fail].
[1 + 1 <= 2 - 1? #fail | #pass].
[0.5 * 2 > 0.75? #pass | #fail].
[-3 > -2.5? #fail | #pass].
[5 * 2 >= 2.5 * 4? #pass | #fail].
[21 <= 6.9 * 3? #fail | #pass].

|* Specialized tests to ensure we're copying tests correctly, since like
|* abstractions they have internal chains for consequent and alternative
|* which need special handling while copying.  We must test both the copy
|* and the the substitution (overwrite-in-place) case.
$echo "Testing test-node substitution and copying".
[f, x. f (x)] ([y. [y? #pass | #fail]], 0 + 1).
[toggle. 1; toggle; toggle; toggle; toggle] ([b. [b? 0 | 1]]).

$echo "Testing reduction inside tests".
[x. [1 + 1 + x? #a | #b]].
[#t? 1 + 1 | 2 + 2].
[n. [#t? 3 * 3 | n + 10]] (5).
[f. [#t? 5; f | 2; f; f]] ([n. n * 2]).
